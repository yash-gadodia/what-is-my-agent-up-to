<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lorong AI x Codex | Agent Mission Room</title>
    <link rel="icon" type="image/png" href="/assets/characters/char_0.png" />
    <link rel="shortcut icon" href="/assets/characters/char_0.png" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@600;700;800&family=Nunito:wght@400;600;700;800&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/styles.css" />
  </head>
  <body>
    <main class="shell">
      <header class="brand-strip" aria-label="Lorong AI and Codex branding">
        <div class="brand-block lorong-brand">
          <img src="/assets/lorong-ai-logo-1200.png" alt="Lorong AI logo" class="lorong-logo" />
        </div>
        <div class="brand-block codex-brand">
          <video class="codex-video" autoplay muted loop playsinline aria-label="Codex animated logo">
            <source src="/assets/codex-logo.mp4" type="video/mp4" />
          </video>
          <div>
            <p class="brand-kicker">Powered by OpenAI</p>
            <p class="brand-name">Codex</p>
            <p class="brand-subtitle">Live agent mission control</p>
          </div>
        </div>
      </header>

      <header id="topSummaryBar" class="top-summary" aria-live="polite">
        <div class="top-summary-track">
          <section class="summary-context" aria-label="Session context">
            <p id="summaryRunIdentity" class="summary-context-line">Lorong: Waiting · Workflow main</p>
            <p id="summaryContextStatus" class="summary-context-line">
              <span id="summaryMode" class="context-token">Live</span>
              <span class="context-sep">·</span>
              <span class="context-dot" aria-hidden="true"></span>
              <span id="summaryConnection" class="context-token">Connecting</span>
            </p>
          </section>

          <section id="summaryHealth" class="summary-health health-degraded" aria-label="System health cluster">
            <p id="summaryHealthTitle" class="summary-health-title">DEGRADED SYSTEM</p>
            <p id="summaryHealthLine" class="summary-health-line">0 Needs Attention · 0 Stalled · 0 Approvals</p>
            <p id="summaryHealthSince" class="summary-health-since">No active blockers</p>
          </section>

          <section class="summary-action" aria-label="Primary action">
            <p id="summaryRuntime" class="summary-action-metrics">0s runtime · First anomaly n/a</p>
            <button id="summaryPrimaryCta" type="button" class="summary-cta summary-cta-ops">Review Alerts (0)</button>
            <p id="summaryAnnouncement" class="summary-announcement is-hidden">Announcement: waiting for command</p>
          </section>

          <div class="summary-start-wrap" aria-label="Demo start">
            <button id="summaryRunSimBtn" type="button" class="summary-cta summary-cta-run">Watch a Demo <span class="summary-cta-icon" aria-hidden="true">&#9654;</span></button>
          </div>
        </div>
      </header>

      <section class="stage" aria-label="Control room map">
        <div class="stage-controls" aria-label="Viewport controls">
          <div class="view-toggle segmented" role="group" aria-label="View mode">
            <button id="viewCityBtn" type="button" class="button-chip active">City</button>
            <button id="viewPaneBtn" type="button" class="button-chip">Pane</button>
          </div>
        </div>
        <div id="mapViewport" class="map-wrap">
          <div id="demoScriptBanner" class="demo-script-banner" hidden>
            <span class="demo-script-label">Demo Script</span>
            <p id="demoScriptText" class="demo-script-text">Step 1: Agents start working across lanes.</p>
          </div>
          <canvas id="cityCanvas" width="1280" height="720"></canvas>
          <div id="mapOverlay" class="map-overlay" aria-label="Agent tiles" role="listbox"></div>
          <p id="runBadge" class="run-badge">No run selected</p>

          <section id="approvalStreet" class="approval-street approval-street-overlay collapsed" aria-label="Approval street" hidden>
            <div class="approval-head">
              <div id="approvalStreetSign" class="approval-sign" aria-hidden="true">Lorong Approval</div>
              <p id="approvalCount" class="chip">0 pending</p>
              <button id="approveNextBtn" type="button">Approve next</button>
              <button id="batchApproveBtn" type="button">Batch approve</button>
            </div>
            <div id="approvalStreetBody" class="approval-body">
              <div id="approvalList" class="approval-list"></div>
            </div>
          </section>
        </div>
        <div id="paneViewport" class="pane-wrap" aria-label="Agent pane view"></div>
      </section>
    </main>

    <button id="opsTab" type="button" class="ops-tab" aria-controls="opsDrawer" aria-expanded="false">
      OPS
      <span id="opsTabBadge" class="ops-tab-badge">0</span>
    </button>

    <aside id="opsDrawer" class="drawer-panel drawer-left" aria-label="Ops drawer" aria-hidden="true">
      <div class="section-head">
        <h1>Ops</h1>
        <button id="opsDrawerClose" type="button">Close</button>
      </div>

      <section class="queue-section" aria-label="Needs attention queue">
        <div class="section-head tight">
          <h2>Needs Attention Queue</h2>
        </div>
        <ul id="attentionQueue" class="attention-queue"></ul>
      </section>

      <section class="agent-list-section" aria-label="Compact agent list">
        <div class="section-head tight">
          <h2>Compact Agent List</h2>
        </div>
        <div class="filters">
          <input id="agentSearch" type="text" placeholder="Search agent" />
          <select id="phaseFilter">
            <option value="all">All phases</option>
            <option value="plan">Plan</option>
            <option value="execute">Execute</option>
            <option value="verify">Verify</option>
            <option value="report">Report</option>
            <option value="approval">Approval</option>
          </select>
          <select id="statusFilter">
            <option value="all">All status</option>
            <option value="active">Active</option>
            <option value="waiting">Waiting</option>
            <option value="needs-human">Needs human</option>
            <option value="blocked">Blocked</option>
            <option value="loop">Loop</option>
            <option value="failed">Failed</option>
            <option value="done">Done</option>
          </select>
          <select id="typeFilter">
            <option value="all">All types</option>
            <option value="main">Main</option>
            <option value="manual">Manual</option>
            <option value="simulated">Simulated</option>
          </select>
        </div>
        <div class="agent-table-wrap">
          <table class="agent-table">
            <thead>
              <tr>
                <th>Agent</th>
                <th>Phase</th>
                <th>Status</th>
                <th>Runtime</th>
                <th>Last Action</th>
              </tr>
            </thead>
            <tbody id="agentTableBody"></tbody>
          </table>
        </div>
      </section>

      <section class="devtools-section">
        <button id="opsDevtoolsToggle" type="button" class="devtools-toggle" aria-expanded="false" aria-controls="opsDevtoolsPanel">
          Dev tools
        </button>
        <div id="opsDevtoolsPanel" class="devtools-panel" hidden>
          <div class="control-group" aria-label="Controls">
            <div class="row">
              <button id="newRunBtn" type="button">New Run</button>
              <button id="reconnectBtn" type="button">Reconnect</button>
            </div>
            <div class="row">
              <button id="simPackBtn" type="button">Simulator Pack</button>
              <button id="simScoldedBtn" type="button">Sim scolded</button>
              <button id="simLongtaskBtn" type="button">Sim longtask</button>
              <button id="simAsleepBtn" type="button">Sim asleep</button>
            </div>
            <div class="row controls-inline">
              <label class="toggle"><input id="reducedMotionToggle" type="checkbox" /> Reduced motion</label>
              <label class="toggle"><input id="colorblindToggle" type="checkbox" /> Colorblind palette</label>
              <label class="field-inline" for="tileSizeSelect"
                >Tile size
                <select id="tileSizeSelect">
                  <option value="s">S</option>
                  <option value="m" selected>M</option>
                  <option value="l">L</option>
                </select>
              </label>
            </div>
          </div>

          <section class="replay-bar" aria-label="Replay controls">
            <div class="row replay-row">
              <button id="playPauseBtn" type="button">Play</button>
              <button id="liveViewBtn" type="button">Live View</button>
              <label class="field-inline" for="replaySpeed"
                >Speed
                <select id="replaySpeed">
                  <option value="1">1x</option>
                  <option value="2">2x</option>
                  <option value="5">5x</option>
                </select>
              </label>
              <button id="exportRunBtn" type="button">Export JSONL</button>
              <label class="import-label" for="importRunInput">Import JSONL</label>
              <input id="importRunInput" type="file" accept=".jsonl,.txt,.json" />
            </div>
            <input id="replaySlider" type="range" min="0" max="0" value="0" />
            <p id="replayInfo" class="muted">Replay: ready</p>
          </section>
        </div>
      </section>
    </aside>

    <div id="opsBackdrop" class="drawer-backdrop" hidden></div>

    <aside id="agentDrawer" class="drawer-panel drawer-right" aria-label="Agent drilldown" aria-hidden="true">
      <div class="section-head">
        <h2>Agent Drilldown</h2>
        <button id="agentDrawerClose" type="button">Close</button>
      </div>
      <section id="drawer" class="drawer" aria-live="polite">
        <h3 id="drawerTitle" class="drawer-title">No agent selected</h3>
        <p id="drawerTask" class="drawer-task">Select an agent tile, queue card, or table row.</p>
        <div id="drawerStatusRow" class="drawer-status-row">
          <span id="drawerStatusChip" class="state-badge state-waiting">⏳ waiting</span>
          <span id="drawerPhaseChip" class="chip">Phase: n/a</span>
          <span id="drawerAttentionChip" class="chip">Attention: none</span>
        </div>
        <div class="drawer-kpi-grid">
          <div class="drawer-kpi"><span>Runtime</span><strong id="drawerRuntime">0s</strong></div>
          <div class="drawer-kpi"><span>Tools</span><strong id="drawerTools">0</strong></div>
          <div class="drawer-kpi"><span>Files</span><strong id="drawerFiles">0</strong></div>
          <div class="drawer-kpi"><span>Errors</span><strong id="drawerErrors">0</strong></div>
          <div class="drawer-kpi"><span>Last success</span><strong id="drawerLastSuccess">n/a</strong></div>
          <div class="drawer-kpi"><span>Blocker</span><strong id="drawerBlocker">none</strong></div>
        </div>
        <div class="drawer-actions row">
          <button id="jumpFirstAnomalyBtn" type="button">Jump to first anomaly</button>
          <button id="provideInputBtn" type="button">Provide input</button>
        </div>
        <section>
          <h4>Recommended Actions</h4>
          <ul id="drawerRecommendations" class="drawer-list"></ul>
        </section>
        <section>
          <h4>Last 20 Events</h4>
          <ul id="drawerEvents" class="drawer-list events"></ul>
        </section>
      </section>
    </aside>

    <div id="agentDrawerBackdrop" class="drawer-backdrop" hidden></div>

    <div id="opsToast" class="ops-toast" hidden role="status" aria-live="polite"></div>

    <script type="module" src="/app.js"></script>
  </body>
</html>
